<div class="dashboard-container">
  <!-- Sidebar -->
  <app-sidebar></app-sidebar>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Header -->
    <header class="dashboard-header">
      <div class="header-title">
        <i class="fa-solid fa-chart-pie header-icon"></i>
        <h1>Meus Investimentos</h1>
      </div>
      <button class="btn-add" (click)="addInvestment()">
        <i class="fa-solid fa-plus"></i> Novo Investimento
      </button>
    </header>

    <!-- Resumo -->
    <section class="summary-cards">
      <div class="card">
        <div class="card-icon">
          <i class="fa-solid fa-coins" style="color: #f39c12;"></i>
        </div>
        <div class="card-content">
          <h3>Total Investido</h3>
          <p class="card-value">R$ {{ totalInvested.toLocaleString('pt-BR', {minimumFractionDigits: 2}) }}</p>
        </div>
      </div>

      <div class="card">
        <div class="card-icon">
          <i class="fa-solid fa-chart-line" style="color: #0066cc;"></i>
        </div>
        <div class="card-content">
          <h3>Valor Atual</h3>
          <p class="card-value">R$ {{ totalCurrentValue.toLocaleString('pt-BR', {minimumFractionDigits: 2}) }}</p>
        </div>
      </div>

      <div class="card card-primary">
        <div class="card-icon">
          <i class="fa-solid fa-trophy"></i>
        </div>
        <div class="card-content">
          <h3>Lucro Total</h3>
          <p class="card-value">R$ {{ totalProfit.toLocaleString('pt-BR', {minimumFractionDigits: 2}) }}</p>
        </div>
      </div>

      <div class="card" style="background: linear-gradient(135deg, #27ae60 0%, #229954 100%);">
        <div class="card-icon" style="background: rgba(255, 255, 255, 0.2);">
          <i class="fa-solid fa-percent" style="color: #FFFFFF;"></i>
        </div>
        <div class="card-content">
          <h3 style="color: #FFFFFF; opacity: 0.9;">Rentabilidade</h3>
          <p class="card-value" style="color: #FFFFFF;">{{ totalProfitPercent.toFixed(2) }}%</p>
        </div>
      </div>
    </section>

    <!-- Distribuição por Tipo -->
    <section class="distribution-section">
      <div class="chart-card">
        <h3>Distribuição por Tipo</h3>
        <div class="distribution-grid">
          <div class="distribution-item" *ngFor="let item of investmentsByType">
            <div class="distribution-info">
              <span class="distribution-type">{{ item.type }}</span>
              <span class="distribution-count">{{ item.count }} {{ item.count === 1 ? 'investimento' : 'investimentos' }}</span>
            </div>
            <div class="distribution-value">
              R$ {{ item.total.toLocaleString('pt-BR', {minimumFractionDigits: 2}) }}
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Lista de Investimentos -->
    <section class="transactions-section">
      <div class="section-header">
        <h2>Meus Investimentos</h2>
      </div>

      <div class="investments-grid">
        <div class="investment-card" *ngFor="let investment of investments">
          <div class="investment-header">
            <div class="investment-type-badge">{{ investment.type }}</div>
            <div class="investment-actions">
              <button class="action-btn" (click)="editInvestment(investment)">
                <i class="fa-solid fa-pen"></i>
              </button>
              <button class="action-btn delete" (click)="deleteInvestment(investment)">
                <i class="fa-solid fa-trash"></i>
              </button>
            </div>
          </div>

          <h3 class="investment-name">{{ investment.name }}</h3>

          <div class="investment-details">
            <div class="detail-row">
              <span class="detail-label">Investido</span>
              <span class="detail-value">R$ {{ investment.amount.toLocaleString('pt-BR', {minimumFractionDigits: 2}) }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Valor Atual</span>
              <span class="detail-value">R$ {{ (investment.currentValue ?? investment.amount).toLocaleString('pt-BR', {minimumFractionDigits: 2}) }}</span>
            </div>
            <div class="detail-row profit">
              <span class="detail-label">Lucro</span>
              <span class="detail-value">
                R$ {{ (investment.profit ?? 0).toLocaleString('pt-BR', {minimumFractionDigits: 2}) }}
                <span class="profit-percent">(+{{ (investment.profitPercent ?? 0).toFixed(1) }}%)</span>
              </span>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Transaction Modal -->
  <app-transaction-modal 
    (onSuccess)="onTransactionSuccess()">
  </app-transaction-modal>
</div>
