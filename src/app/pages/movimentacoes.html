<div class="dashboard-container">
  <!-- Sidebar -->
  <app-sidebar></app-sidebar>

  <!-- Loading Overlay -->
  <app-loading-spinner *ngIf="isLoading" [overlay]="true" message="Carregando movimentações..."></app-loading-spinner>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Header -->
    <header class="dashboard-header">
      <div class="header-title">
        <i class="fa-solid fa-money-bill-transfer header-icon"></i>
        <h1>Movimentações Financeiras</h1>
      </div>
      <button class="btn-add" (click)="addTransaction()">
        <i class="fa-solid fa-plus"></i> Nova Movimentação
      </button>
    </header>

    <ng-container *ngIf="!isLoading">
    <!-- Resumo -->
    <section class="summary-cards">
      <div class="card">
        <div class="card-icon">
          <i class="fa-solid fa-arrow-trend-up" style="color: #27ae60;"></i>
        </div>
        <div class="card-content">
          <h3>Receitas</h3>
          <p class="card-value" style="color: #27ae60;">R$ {{ totalIncome.toLocaleString('pt-BR', {minimumFractionDigits: 2}) }}</p>
        </div>
      </div>

      <div class="card">
        <div class="card-icon">
          <i class="fa-solid fa-arrow-trend-down" style="color: #e74c3c;"></i>
        </div>
        <div class="card-content">
          <h3>Despesas</h3>
          <p class="card-value" style="color: #e74c3c;">R$ {{ totalExpense.toLocaleString('pt-BR', {minimumFractionDigits: 2}) }}</p>
        </div>
      </div>

      <div class="card card-primary">
        <div class="card-icon">
          <i class="fa-solid fa-wallet"></i>
        </div>
        <div class="card-content">
          <h3>Saldo</h3>
          <p class="card-value">R$ {{ balance.toLocaleString('pt-BR', {minimumFractionDigits: 2}) }}</p>
        </div>
      </div>
    </section>

    <!-- Filtros -->
    <section class="filters-section">
      <div class="filter-tabs">
        <button 
          class="filter-tab" 
          [class.active]="filterType === 'all'"
          (click)="filterType = 'all'">
          Todas
        </button>
        <button 
          class="filter-tab" 
          [class.active]="filterType === 'income'"
          (click)="filterType = 'income'">
          Receitas
        </button>
        <button 
          class="filter-tab" 
          [class.active]="filterType === 'expense'"
          (click)="filterType = 'expense'">
          Despesas
        </button>
      </div>
    </section>

    <!-- Lista de Movimentações -->
    <section class="transactions-section">
      <div class="transactions-list">
        <div 
          class="transaction-item" 
          *ngFor="let transaction of filteredTransactions"
          [class.income]="transaction.type === 'income'"
          [class.expense]="transaction.type === 'expense'">
          
          <div class="transaction-icon">
            <i class="fa-solid" [class.fa-arrow-up]="transaction.type === 'income'" [class.fa-arrow-down]="transaction.type === 'expense'"></i>
          </div>
          
          <div class="transaction-info">
            <h4>{{ transaction.description }}</h4>
            <span class="transaction-category">{{ transaction.category }}</span>
          </div>
          
          <div class="transaction-date">
            <span>{{ transaction.date }}</span>
          </div>
          
          <div class="transaction-amount">
            <span>{{ transaction.type === 'income' ? '+' : '-' }} R$ {{ transaction.amount.toLocaleString('pt-BR', {minimumFractionDigits: 2}) }}</span>
          </div>
          
          <div class="transaction-actions">
            <button class="action-btn" (click)="editTransaction(transaction)">
              <i class="fa-solid fa-pen"></i>
            </button>
            <button class="action-btn delete" (click)="deleteTransaction(transaction)">
              <i class="fa-solid fa-trash"></i>
            </button>
          </div>
        </div>

        <div class="empty-state" *ngIf="filteredTransactions.length === 0">
          <i class="fa-solid fa-inbox"></i>
          <p>Nenhuma movimentação encontrada</p>
        </div>
      </div>
    </section>
    </ng-container>
  </main>

  <!-- Transaction Modal -->
  <app-transaction-modal 
    (onSuccess)="onTransactionSuccess()">
  </app-transaction-modal>
</div>
